@startuml Insurance Claims - Complete Lifecycle Diagram

!theme plain
skinparam backgroundColor #FFFFFF
skinparam roundcorner 10
skinparam defaultFontSize 11
skinparam titleFontSize 20
skinparam actorStyle awesome
skinparam packageStyle rectangle

title **Insurance System - Complete Claims Lifecycle**\nAll Roles, Claim Types, Statuses & Permissions

' ==================== ACTORS ====================
actor "ðŸ‘¤ Insurance Client\n(Patient)" as Client #E1BEE7
actor "ðŸ©º Doctor" as Doctor #C8E6C9
actor "ðŸ’Š Pharmacist" as Pharmacist #BBDEFB
actor "ðŸ”¬ Lab Technician" as LabTech #FFF9C4
actor "ðŸ“· Radiologist" as Radiologist #FFCCBC
actor "ðŸ¥ Medical Admin" as MedicalAdmin #B2DFDB
actor "ðŸ“‹ Coordination Admin" as CoordAdmin #FFE082
actor "ðŸ‘” Insurance Manager" as Manager #B39DDB

' ==================== CLAIM SUBMISSION ====================
package "ðŸ“¥ CLAIM SUBMISSION" as Submission #E8F5E9 {

  rectangle "**Doctor Claim**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâ€¢ Search patient\nâ€¢ Select patient/family\nâ€¢ Enter diagnosis\nâ€¢ Enter treatment\nâ€¢ Set amount (â‚ª)\nâ€¢ Upload invoice" as DoctorSubmit #C8E6C9

  rectangle "**Pharmacist Claim**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâ€¢ Search patient\nâ€¢ Link to prescription\nâ€¢ Enter medications\nâ€¢ Set amount (â‚ª)\nâ€¢ Upload invoice" as PharmSubmit #BBDEFB

  rectangle "**Lab Tech Claim**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâ€¢ Search patient\nâ€¢ Link to lab request\nâ€¢ Enter test details\nâ€¢ Set amount (â‚ª)\nâ€¢ Upload results" as LabSubmit #FFF9C4

  rectangle "**Radiologist Claim**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâ€¢ Search patient\nâ€¢ Link to radiology req\nâ€¢ Enter service type\nâ€¢ Set amount (â‚ª)\nâ€¢ Upload images" as RadioSubmit #FFCCBC

  rectangle "**Client Self-Claim**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”\nâ€¢ Out-of-network\nâ€¢ Enter provider name\nâ€¢ Enter doctor name\nâ€¢ Set amount (â‚ª)\nâ€¢ Upload invoice\n  (REQUIRED)" as ClientSubmit #E1BEE7
}

Doctor --> DoctorSubmit
Pharmacist --> PharmSubmit
LabTech --> LabSubmit
Radiologist --> RadioSubmit
Client --> ClientSubmit

' ==================== STATUSES ====================
package "ðŸ“Š CLAIM STATUS FLOW" as StatusFlow #FFFDE7 {

  rectangle "**ðŸ†• PENDING_MEDICAL**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nNew claim submitted\nAwaiting medical review" as PENDING #FFE0B2

  rectangle "**âœ… APPROVED_BY_MEDICAL**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nMedical approved\nCoverage verified" as APPROVED_MED #C8E6C9

  rectangle "**ðŸ“‹ AWAITING_COORDINATION**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nMedical approved\nAwaiting final decision" as AWAITING_COORD #BBDEFB

  rectangle "**ðŸ”™ RETURNED_FOR_REVIEW**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nReturned to Medical Admin\nNeeds re-review" as RETURNED_MED #FFE082

  rectangle "**â†©ï¸ RETURNED_TO_PROVIDER**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nReturned to submitter\nCorrections needed" as RETURNED_PROV #FFAB91

  rectangle "**âœ… APPROVED_FINAL**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nFully approved\nReady for payment" as APPROVED_FINAL #A5D6A7

  rectangle "**âŒ REJECTED_FINAL**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n**TERMINAL STATE**\nCannot be changed" as REJECTED #EF9A9A

  rectangle "**â³ PAYMENT_PENDING**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nApproved\nAwaiting payment" as PAYMENT_PEND #B3E5FC

  rectangle "**ðŸ’³ PAID**\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n**TERMINAL STATE**\nPayment complete" as PAID #81C784

  ' Status transitions
  DoctorSubmit -down-> PENDING
  PharmSubmit -down-> PENDING
  LabSubmit -down-> PENDING
  RadioSubmit -down-> PENDING
  ClientSubmit -down-> PENDING

  PENDING -right-> APPROVED_MED : Medical\nApproves
  PENDING -down-> REJECTED : Medical\nRejects

  APPROVED_MED -right-> AWAITING_COORD

  AWAITING_COORD -right-> APPROVED_FINAL : Coord\nApproves
  AWAITING_COORD -down-> REJECTED : Coord\nRejects
  AWAITING_COORD -left-> RETURNED_MED : Return to\nMedical
  AWAITING_COORD -up-> RETURNED_PROV : Return to\nProvider

  RETURNED_MED -up-> APPROVED_MED : Re-approve
  RETURNED_MED -down-> REJECTED : Re-reject

  RETURNED_PROV -up-> PENDING : Resubmit

  APPROVED_FINAL -right-> PAYMENT_PEND
  PAYMENT_PEND -right-> PAID : Mark\nPaid
}

' ==================== MEDICAL ADMIN VIEW ====================
package "ðŸ¥ MEDICAL ADMIN VIEW" as MedicalView #B2DFDB {
  rectangle "**Can See:**\nâ€¢ Claims in PENDING_MEDICAL\nâ€¢ Claims in RETURNED_FOR_REVIEW\nâ€¢ Provider details\nâ€¢ Patient/family info\nâ€¢ Service & diagnosis\nâ€¢ Amount requested\nâ€¢ Invoice documents\nâ€¢ Coverage eligibility" as MedSee

  rectangle "**Can Do:**\nâœ… Approve Medical\nâŒ Reject Medical (with reason)\nðŸ“Š View coverage check results\nðŸ“‹ Add medical notes" as MedDo

  rectangle "**Coverage Check:**\nâ€¢ Service covered?\nâ€¢ Age/Gender valid?\nâ€¢ Deductible met?\nâ€¢ Within limits?\nâ€¢ Emergency eligible?" as MedCoverage
}

MedicalAdmin --> MedicalView

' ==================== COORDINATION ADMIN VIEW ====================
package "ðŸ“‹ COORDINATION ADMIN VIEW" as CoordView #FFE082 {
  rectangle "**Can See:**\nâ€¢ Claims in AWAITING_COORDINATION\nâ€¢ All medical review info\nâ€¢ Medical reviewer details\nâ€¢ Coverage calculations\nâ€¢ Insurance vs Client amounts\nâ€¢ Full claim history" as CoordSee

  rectangle "**Can Do:**\nâœ… Approve Final\nâŒ Reject Final (with reason)\nðŸ”™ Return to Medical (with reason)\nâ†©ï¸ Return to Provider (with reason)\nðŸ’³ Mark as Paid\nðŸ“ Create direct claims" as CoordDo

  rectangle "**Payment Info:**\nâ€¢ Insurance Covered: â‚ª___\nâ€¢ Client Pays: â‚ª___\nâ€¢ Coverage %: ___%\nâ€¢ Max limit applied?" as CoordPayment
}

CoordAdmin --> CoordView

' ==================== INSURANCE MANAGER VIEW ====================
package "ðŸ‘” INSURANCE MANAGER VIEW (GOD MODE)" as ManagerView #B39DDB {
  rectangle "**Can See EVERYTHING:**\nâ€¢ ALL claims (any status)\nâ€¢ ALL provider types\nâ€¢ ALL patients\nâ€¢ Full audit trail\nâ€¢ All financial data\nâ€¢ System-wide reports" as MgrSee

  rectangle "**Can Do EVERYTHING:**\nâœ… Medical Approve/Reject\nâœ… Coordination Approve/Reject\nðŸ”™ Return to Medical/Provider\nðŸ’³ Mark as Paid\nðŸ“ Create claims for clients\nðŸ“Š Generate PDF/Excel reports\nðŸ” Advanced search & filter\nðŸ“¦ Batch operations" as MgrDo
}

Manager --> ManagerView

' ==================== HEALTHCARE PROVIDER VIEW ====================
package "ðŸ©ºðŸ’ŠðŸ”¬ðŸ“· HEALTHCARE PROVIDER VIEW" as ProviderView #C5CAE9 {
  rectangle "**Can See:**\nâ€¢ Own submitted claims\nâ€¢ Claim status & history\nâ€¢ Approval/Rejection reasons\nâ€¢ Payment status\nâ€¢ Return reasons (if any)" as ProvSee

  rectangle "**Can Do:**\nðŸ“ Submit new claims\nðŸ‘ï¸ View claim status\nâœï¸ Resubmit if returned\nðŸ“Ž Upload additional docs" as ProvDo

  rectangle "**Cannot Do:**\nâŒ Approve/Reject claims\nâŒ See other providers' claims\nâŒ Modify submitted claims" as ProvCannot
}

Doctor --> ProviderView
Pharmacist --> ProviderView
LabTech --> ProviderView
Radiologist --> ProviderView

' ==================== CLIENT VIEW ====================
package "ðŸ‘¤ CLIENT/PATIENT VIEW" as ClientView #E1BEE7 {
  rectangle "**Can See:**\nâ€¢ Own claims (all types)\nâ€¢ Family member claims\nâ€¢ Claim status\nâ€¢ Insurance covered amount\nâ€¢ Client pay amount\nâ€¢ Rejection reasons" as ClientSee

  rectangle "**Can Do:**\nðŸ“ Submit self-claims\n   (out-of-network)\nðŸ‘ï¸ Track claim status\nðŸ“Ž Upload invoices" as ClientDo

  rectangle "**Cannot Do:**\nâŒ Approve/Reject\nâŒ See other patients\nâŒ See provider details" as ClientCannot
}

Client --> ClientView

' ==================== NOTIFICATIONS ====================
note bottom of StatusFlow
  **ðŸ”” NOTIFICATIONS SENT:**
  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  **On Submit:** â†’ Medical Admins
  **On Medical Approve:** â†’ Provider, Patient, Coord Admins
  **On Medical Reject:** â†’ Provider, Patient
  **On Coord Approve:** â†’ Provider, Patient
  **On Coord Reject:** â†’ Provider, Patient
  **On Return to Medical:** â†’ Medical Admin
  **On Return to Provider:** â†’ Provider
  **On Payment:** â†’ Provider, Patient
end note

' ==================== SPECIAL RULES ====================
note right of DoctorSubmit
  **âš•ï¸ FOLLOW-UP RULE:**
  If same patient + same specialization
  within 14 days of previous visit:
  â€¢ Amount = â‚ª0
  â€¢ isFollowUp = true
  â€¢ Patient pays original fee
  â€¢ Insurance covers only meds/tests
end note

note right of APPROVED_FINAL
  **ðŸ’° COVERAGE CALCULATION:**
  Insurance Pay = Amount Ã— (Coverage% / 100)
  If Insurance Pay > Max Limit:
    Insurance Pay = Max Limit
  Client Pay = Amount - Insurance Pay

  **ðŸš¨ EMERGENCY BYPASS:**
  If emergency = true AND service eligible:
    Coverage = 100%
end note

@enduml
